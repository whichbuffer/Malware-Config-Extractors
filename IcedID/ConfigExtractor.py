# IcedID Malware - Static Config Extractor
# Arda Büyükkaya - @WhichbufferArda

from arc4 import ARC4

def unhex(hex_string):
    import binascii
    if type(hex_string) == str:
        return binascii.unhexlify(hex_string.encode('utf-8'))
    else:
        return binascii.unhexlify(hex_string)

def rc4_decrypt(key,data):
    cipher = ARC4(key)
    decrypted = cipher.decrypt(data)
    return decrypted

def main():
    data = unhex(input("Config: "))
    
    key = data[:8]
    data = data[8:]

    unencrypted = rc4_decrypt(key,data).replace(b'\x00',b'')
    print(unencrypted)
if __name__ == '__main__':
    main()
